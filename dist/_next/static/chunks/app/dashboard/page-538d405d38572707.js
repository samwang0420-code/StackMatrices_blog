(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{6695:function(e,s,t){Promise.resolve().then(t.bind(t,441))},441:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var a=t(7437),r=t(2265),n=t(7648),i=t(4902),l=t(1837);function c(){let{user:e,loading:s}=(0,i.a)(),[t,c]=(0,r.useState)([]),[d,o]=(0,r.useState)([]),[h,x]=(0,r.useState)(!0),[m,u]=(0,r.useState)("");if((0,r.useEffect)(()=>{e&&s();async function s(){try{x(!0),u("");let[e,s]=await Promise.all([l.h.getMyLicenses().catch(()=>({licenses:[]})),l.h.getMyOrders().catch(()=>({orders:[]}))]);c(e.licenses||[]),o(s.orders||[])}catch(e){console.error("Error fetching dashboard data:",e),e instanceof l.S&&401===e.status?u("登录已过期，请重新登录"):u("加载数据失败，请稍后重试")}finally{x(!1)}}},[e]),s||h)return(0,a.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-slate-500",children:"加载中..."})});if(!e)return(0,a.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-slate-600 mb-4",children:"请先登录"}),(0,a.jsx)(n.default,{href:"/login",className:"py-2 px-4 bg-primary text-white rounded-lg",children:"去登录"})]})});let p=e=>({explorer:100,creator:500,team:2e3})[e]||0,b=e=>({explorer:"探索版",creator:"创作者版",team:"团队版"})[e]||e,g=e=>{navigator.clipboard.writeText(e),alert("已复制到剪贴板")};return(0,a.jsx)("div",{className:"min-h-screen bg-slate-50 py-12 px-4",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"用户面板"}),(0,a.jsx)("p",{className:"text-slate-600",children:e.email})]}),m&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-600",children:[m,(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"ml-4 text-sm underline",children:"重试"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"我的 License"}),(0,a.jsx)(n.default,{href:"/pricing",className:"text-sm text-primary font-medium hover:underline",children:"购买新 License"})]}),0===t.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-slate-50 rounded-lg",children:[(0,a.jsx)("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),(0,a.jsx)("p",{className:"text-slate-500 mb-4",children:"还没有 License"}),(0,a.jsx)(n.default,{href:"/pricing",className:"inline-block py-2 px-4 bg-primary text-white rounded-lg font-medium",children:"去购买"})]}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{let s=p(e.tier),t=e.monthly_requests,r=s>0?t/s*100:0;return(0,a.jsxs)("div",{className:"border border-slate-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"inline-block px-2 py-1 bg-primary/10 text-primary text-xs font-bold rounded mb-2",children:b(e.tier)}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("code",{className:"bg-slate-100 px-2 py-1 rounded text-sm font-mono",children:e.key}),(0,a.jsx)("button",{onClick:()=>g(e.key),className:"text-slate-400 hover:text-primary",title:"复制",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("active"===e.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:"active"===e.status?"有效":"已过期"})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-slate-600",children:"本月用量"}),(0,a.jsxs)("span",{className:"font-medium",children:[t," / ",s]})]}),(0,a.jsx)("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full rounded-full ".concat(r>90?"bg-red-500":r>70?"bg-yellow-500":"bg-primary"),style:{width:"".concat(Math.min(r,100),"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["剩余 ",Math.max(0,s-t)," 次调用"]})]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["到期时间: ",new Date(e.expires_at).toLocaleDateString("zh-CN")]})]},e.id)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"使用说明"}),(0,a.jsx)("div",{className:"bg-slate-900 rounded-lg p-4 overflow-x-auto",children:(0,a.jsx)("pre",{className:"text-sm text-green-400",children:'# 设置环境变量\nexport SKILL_APIFY_LICENSE_KEY=你的-License-Key\n\n# Python 中使用\nfrom skill_apify_black_box import get_reviews\n\nreviews = get_reviews("Notion", source="g2", limit=10)'})}),(0,a.jsxs)("p",{className:"text-sm text-slate-600 mt-4",children:["详细文档请参考"," ",(0,a.jsx)("a",{href:"https://api.gspr-hub.site/docs",className:"text-primary hover:underline",target:"_blank",rel:"noopener",children:"API 文档"})]})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-6",children:"我的订单"}),0===d.length?(0,a.jsx)("p",{className:"text-slate-500 text-center py-8",children:"暂无订单"}):(0,a.jsx)("div",{className:"space-y-4",children:d.map(e=>(0,a.jsx)("div",{className:"border-b border-slate-100 last:border-0 pb-4 last:pb-0",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:b(e.tier)}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:e.created_at?new Date(e.created_at).toLocaleDateString("zh-CN"):"N/A"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-bold",children:["\xa5",e.amount/100]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("paid"===e.status?"bg-green-100 text-green-700":"pending"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:"paid"===e.status?"已完成":"pending"===e.status?"审核中":"已取消"})]})]})},e.id))})]})})]})]})})}},4902:function(e,s,t){"use strict";t.d(s,{AuthProvider:function(){return l},a:function(){return c}});var a=t(7437),r=t(2265);let n=(0,t(3053).eI)("https://fixemvsckapejyfwphft.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZpeGVtdnNja2FwZWp5ZndwaGZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE5MTQ3MzUsImV4cCI6MjA4NzQ5MDczNX0.3TC1YUPqQpix7YWedmsHrDOcQWhhK0HcL1CKRp0S86lPsJsBefPPAUdDmKXMXpVbheItdVrwamW0YfUm1EAwRQ=="),i=(0,r.createContext)(void 0);function l(e){let{children:s}=e,[t,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{n.auth.getSession().then(e=>{let{data:{session:s}}=e;(null==s?void 0:s.user)&&l({id:s.user.id,email:s.user.email}),d(!1)});let{data:{subscription:e}}=n.auth.onAuthStateChange((e,s)=>{(null==s?void 0:s.user)?l({id:s.user.id,email:s.user.email}):l(null)});return()=>e.unsubscribe()},[]);let o=async(e,s)=>{let{error:t}=await n.auth.signInWithPassword({email:e,password:s});return{error:t}},h=async(e,s)=>{let{error:t}=await n.auth.signUp({email:e,password:s,options:{emailRedirectTo:"".concat(window.location.origin,"/dashboard")}});return{error:t}},x=async()=>{await n.auth.signOut(),l(null)};return(0,a.jsx)(i.Provider,{value:{user:t,loading:c,signIn:o,signUp:h,signOut:x},children:s})}function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1837:function(e,s,t){"use strict";t.d(s,{S:function(){return a},h:function(){return n}});class a extends Error{constructor(e,s){super(e),this.status=s,this.name="ApifyAPIError"}}async function r(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat("https://api.gspr-hub.site/v1").concat(e),r=localStorage.getItem("sb-access-token"),n={"Content-Type":"application/json",...s.headers};r&&(n.Authorization="Bearer ".concat(r));let i=await fetch(t,{...s,headers:n});if(!i.ok)throw new a((await i.json().catch(()=>({detail:"Unknown error"}))).detail||"HTTP ".concat(i.status),i.status);return i.json()}let n={getMe:async()=>r("/auth/me"),getMyLicenses:async()=>r("/licenses/my"),getLicenseUsage:async e=>r("/licenses/".concat(e,"/usage")),createOrder:async(e,s)=>r("/orders/create",{method:"POST",body:JSON.stringify({tier:e,screenshot_url:s})}),getMyOrders:async()=>r("/orders/my"),async searchReviews(e,s,t){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return r("/reviews/search",{method:"POST",headers:{"X-License-Key":t},body:JSON.stringify({product:e,source:s,limit:a})})}}}},function(e){e.O(0,[972,434,16,971,117,744],function(){return e(e.s=6695)}),_N_E=e.O()}]);